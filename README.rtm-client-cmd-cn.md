# FPNN RTM CLIENT CMD LIST #
[English Version](README.md)

## 一、介绍 ##
* 本文档详细描述RTM客户端函数接口，熟悉FPNN协议的可以直接使用。
* 接口返回错误请见: fpnn-error-code, rtm-error-code

## 二、使用流程 ##
* 1，通过管理系统获取Dispatch服务的地址
* 2，通过管理系统获取后端访问地址及security key
* 3，连接RTM后端，获取用户的token
* 4，连接Dispatch，获取一个可用且性能最好的前端接入点
* 5，连接此前端接入点，发送auth命令
* 6，登录成功，正常使用各种命令
* 7，如果登录返回false，则从第三步开始从新来过

## 三、客户端接口详情 ##
### 1. Dispatch相关 ###
#### (1) which ####
说明：获取一个可用的RTM前端服务地址

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| what | 字符串 | 必选 | 返回何种服务，在RTM中默认为：rtmGated |
| iptype | 字符串 | 必选 | 前端接入点，取值范围：ip4，ip6，domain |
| proto | 字符串 | 必选 | 协议，TCP，UDP，HTTP |
| version | 字符串 | 可选 | 当前SDK版本号 |


| 输出参数 | 类型 | 描述 |
|------|-------|------|
| server | 字符串 | 格式：ip4:port, ip6:port, domain:port |

#### (2) whichall ####
说明：获取一个可用的RTM前端服务地址

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| what | 字符串 | 必选 | 返回何种服务，在RTM中默认为：rtmGated |
| iptype | 字符串 | 必选 | 前端接入点，取值范围：ip4，ip6，domain |
| proto | 字符串 | 必选 | 协议，TCP，UDP，HTTP |
| version | 字符串 | 可选 | 当前SDK版本号 |


| 输出参数 | 类型 | 描述 |
|------|-------|------|
| servers | 字符串数组 | 返回所有可用服务列表，格式：ip4:port, ip6:port, domain:port |

### 2. 登录相关 ###
#### (1) auth ####
说明：登录认证

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| pid | 32位整数 | 必选 | 项目ID |
| uid | 64位整数 | 必选 | 需要登录的用户ID |
| token | 字符串 | 必选 | 用户登录 token，需要通过业务后端获取 |
| version | 字符串 | 可选 | 当前SDK版本号 |
| unread | 布尔型 | 可选 | 用户登录成功后是否接受服务器主动推送的未读消息，（注意：服务端也需要配置） |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| ok | 布尔型 |  是否成功，true则登录成功，否则返回false |
| gate | 字符串 |  在容许multilogin的情况下，强制用户登录到同一台前端机 |

### 3. 发送文本消息 ###
#### (1) sendmsg ####
说明：发送P2P消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| to | 64位整数 | 必选 | 接收消息的用户ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| msg | 字符串 | 必选 | 消息内容 |
| attrs | 字符串 | 必选 | 消息附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (2) sendmsgs ####
说明：给多个人发送消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| tos | 64位整数数组 | 必选 | 接收消息的用户ID列表 |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| msg | 字符串 | 必选 | 消息内容 |
| attrs | 字符串 | 必选 | 消息附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (3) sendgroupmsg ####
说明：给一个组发送消息，用户必须在当前组

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| gid | 64位整数 | 必选 | 接收消息的组ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| msg | 字符串 | 必选 | 消息内容 |
| attrs | 字符串 | 必选 | 消息附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (4) sendroommsg ####
说明：给一个房间发送消息，用户必须在当前房间

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| rid | 64位整数 | 必选 | 接收消息的房间ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| msg | 字符串 | 必选 | 消息内容 |
| attrs | 字符串 | 必选 | 消息附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

### 4. 获取历史消息 ###
#### (1) getgroupmsg ####
说明：获取指定组的历史消息，用户必须在组里

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| gid | 64位整数 | 必选 | 组ID |
| num | 16位整数 | 必选 | 获取多少条消息，一次最多10条 |
| desc | 布尔值 | 必选 | 历史消息排序方式，true: 降序，false：升序 |
| page | 16位整数 | 必选 | 第几页消息，第一页传0，第二页传1 |
| localmid | 64位整数 | 可选 | 本地保存的最新的消息的mid，一般是push收到的，没有则传0，服务器会返回此mid之后的新消息，翻页时，这个参数的值保持不变 |
| localid | 64位整数 | 可选 | 本地保存的上次登陆期间获取到的最大消息id，没有则传0，服务器会返回大于这个id的所有消息，翻页时，这个参数的值保持不变 |
| mtypes | 8位整数数组 | 可选 | 需要获取指定的mtype的历史消息 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| num | 16位整数 |  实际返回的消息条数 |
| maxid | 64位整数 |  返回消息中的最大的msg_id，如果比本地缓存的localid大，则需要更新此值 |
| msgs | 消息结构体的数组 |  消息列表 |

msgs消息体说明：

| 参数 | 类型 | 描述 |
|------|-------|------|
| id | 64位整数 |  本条消息在当前会话中的序号 |
| from | 64位整数 |  发送者ID |
| mtype | 8位整数 |  消息类别 |
| ftype | 8位整数 |  是否文本消息或者文件，如果是文件，则 msg 字段为文件下载地址，ftype取值见附录 |
| mid | 64位整数 | 消息的唯一标识 |
| msg | 字符串 | 消息内容 |
| attrs | 字符串 | 消息附加属性 |
| mtime | 32位整数 | 消息发送时间 |

#### (2) getroommsg ####
说明：获取指定房间的历史消息，用户必须在房间里

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| rid | 64位整数 | 必选 | 房间ID |
| num | 16位整数 | 必选 | 获取多少条消息，一次最多10条 |
| desc | 布尔值 | 必选 | 历史消息排序方式，true: 降序，false：升序 |
| page | 16位整数 | 必选 | 第几页消息，第一页传0，第二页传1 |
| localmid | 64位整数 | 可选 | 本地保存的最新的消息的mid，一般是push收到的，没有则传0，服务器会返回此mid之后的新消息，翻页时，这个参数的值保持不变 |
| localid | 64位整数 | 可选 | 本地保存的上次登陆期间获取到的最大消息id，没有则传0，服务器会返回大于这个id的所有消息，翻页时，这个参数的值保持不变 |
| mtypes | 8位整数数组 | 可选 | 需要获取指定的mtype的历史消息 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| num | 16位整数 |  实际返回的消息条数 |
| maxid | 64位整数 |  返回消息中的最大的msg_id，如果比本地缓存的localid大，则需要更新此值 |
| msgs | 消息结构体的数组 |  消息列表 |

msgs消息体说明：

| 参数 | 类型 | 描述 |
|------|-------|------|
| id | 64位整数 |  本条消息在当前会话中的序号 |
| from | 64位整数 |  发送者ID |
| mtype | 8位整数 |  消息类别 |
| ftype | 8位整数 |  是否文本消息或者文件，如果是文件，则 msg 字段为文件下载地址，ftype取值见附录 |
| mid | 64位整数 | 消息的唯一标识 |
| msg | 字符串 | 消息内容 |
| attrs | 字符串 | 消息附加属性 |
| mtime | 32位整数 | 消息发送时间 |

#### (3) getbroadcastmsg ####
说明：获取广播的历史消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| num | 16位整数 | 必选 | 获取多少条消息，一次最多10条 |
| desc | 布尔值 | 必选 | 历史消息排序方式，true: 降序，false：升序 |
| page | 16位整数 | 必选 | 第几页消息，第一页传0，第二页传1 |
| localmid | 64位整数 | 可选 | 本地保存的最新的消息的mid，一般是push收到的，没有则传0，服务器会返回此mid之后的新消息，翻页时，这个参数的值保持不变 |
| localid | 64位整数 | 可选 | 本地保存的上次登陆期间获取到的最大消息id，没有则传0，服务器会返回大于这个id的所有消息，翻页时，这个参数的值保持不变 |
| mtypes | 8位整数数组 | 可选 | 需要获取指定的mtype的历史消息 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| num | 16位整数 |  实际返回的消息条数 |
| maxid | 64位整数 |  返回消息中的最大的msg_id，如果比本地缓存的localid大，则需要更新此值 |
| msgs | 消息结构体的数组 |  消息列表 |

msgs消息体说明：

| 参数 | 类型 | 描述 |
|------|-------|------|
| id | 64位整数 |  本条消息在当前会话中的序号 |
| from | 64位整数 |  发送者ID |
| mtype | 8位整数 |  消息类别 |
| ftype | 8位整数 |  是否文本消息或者文件，如果是文件，则 msg 字段为文件下载地址，ftype取值见附录 |
| mid | 64位整数 | 消息的唯一标识 |
| msg | 字符串 | 消息内容 |
| attrs | 字符串 | 消息附加属性 |
| mtime | 32位整数 | 消息发送时间 |

#### (4) getp2pmsg ####
说明：获取和指定用户间的历史消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| ouid | 64位整数 | 必选 | 获取和哪个用户之间的历史消息 |
| num | 16位整数 | 必选 | 获取多少条消息，一次最多10条 |
| direction | 8位整数 | 必选 | 0: 获取发送的+接收的, 1: 只获取自己发送的消息, 2: 只获取接收的消息 |
| desc | 布尔值 | 必选 | 历史消息排序方式，true: 降序，false：升序 |
| page | 16位整数 | 必选 | 第几页消息，第一页传0，第二页传1 |
| localmid | 64位整数 | 可选 | 本地保存的最新的消息的mid，一般是push收到的，没有则传0，服务器会返回此mid之后的新消息，翻页时，这个参数的值保持不变 |
| localid | 64位整数 | 可选 | 本地保存的上次登陆期间获取到的最大消息id，没有则传0，服务器会返回大于这个id的所有消息，翻页时，这个参数的值保持不变 |
| mtypes | 8位整数数组 | 可选 | 需要获取指定的mtype的历史消息 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| num | 16位整数 |  实际返回的消息条数 |
| maxid | 64位整数 |  返回消息中的最大的msg_id，如果比本地缓存的localid大，则需要更新此值 |
| msgs | 消息结构体的数组 |  消息列表 |

msgs消息体说明：

| 参数 | 类型 | 描述 |
|------|-------|------|
| id | 64位整数 |  本条消息在当前会话中的序号 |
| other_uid | 64位整数 |  发消息给我的人的uid，或者我发消息给对方的uid |
| direction | 8位整数 |  取值，1：我发出去的消息，2：我收到的消息 |
| mtype | 8位整数 |  消息类别 |
| ftype | 8位整数 |  是否文本消息或者文件，如果是文件，则 msg 字段为文件下载地址，ftype取值见附录 |
| mid | 64位整数 | 消息的唯一标识 |
| msg | 字符串 | 消息内容 |
| attrs | 字符串 | 消息附加属性 |
| mtime | 32位整数 | 消息发送时间 |

#### (5) pushunread ####
说明：获取用户的未读消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  |  |  |


| 输出参数 | 类型 | 描述 |
|------|-------|------|
| p2p | 64位整数数组 | 哪些用户和自己有未读消息 |
| group | 64位整数数组 | 哪些组和自己有未读消息 |
| bc | 布尔型 | 是否有未读的广播消息 |

### 5. 发送文件相关 ###
#### (1) filetoken ####
说明：获取文件服务器的地址及鉴权信息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| cmd | 字符串 | 必选 | 需要调用的发送文件接口，只能是如下4个接口之一：sendfile，sendfiles，sendroomfile，sendgroupfile |
| to | 64位整数 | 可选 | cmd=sendfile 时必须指定此值 |
| tos | 64位整数数组 | 可选 | cmd=sendfiles 时必须指定此值 |
| rid | 64位整数 | 可选 | cmd=sendroomfile 时必须指定此值 |
| gid | 64位整数 | 可选 | cmd=sendgroupfile 时必须指定此值 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| token | 字符串 |  发送文件时鉴权使用，一次有效 |
| endpoint | 字符串 |  文件服务器地址，格式：IP:port |

#### (2) sendfile ####
说明：发送P2P文件

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| pid | 32位整数 | 必选 | 项目ID |
| from | 64位整数 | 必选 | 发送文件的用户ID |
| to | 64位整数 | 必选 | 接收文件的用户ID |
| token | 字符串 | 必选 | filetoken接口返回的字符串token |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| file | 字符串 | 必选 | 文件内容 |
| attrs | 字符串 | 必选 | 文件附加属性，必须使用json格式，必须包含两项：ext：后缀名，sign：校验码 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (3) sendfiles ####
说明：给多个人发送文件

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| pid | 32位整数 | 必选 | 项目ID |
| from | 64位整数 | 必选 | 发送文件的用户ID |
| tos | 64位整数数组 | 必选 | 接收文件的用户ID列表 |
| token | 字符串 | 必选 | filetoken接口返回的字符串token |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| file | 字符串 | 必选 | 文件内容 |
| attrs | 字符串 | 必选 | 文件附加属性，必须使用json格式，必须包含两项：ext：后缀名，sign：校验码 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (3) sendgroupfile ####
说明：给一个组发送文件，用户必须在当前组

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| pid | 32位整数 | 必选 | 项目ID |
| from | 64位整数 | 必选 | 发送文件的用户ID |
| gid | 64位整数 | 必选 | 接收文件的组ID |
| token | 字符串 | 必选 | filetoken接口返回的字符串token |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| file | 字符串 | 必选 | 文件内容 |
| attrs | 字符串 | 必选 | 文件附加属性，必须使用json格式，必须包含两项：ext：后缀名，sign：校验码 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (4) sendroomfile ####
说明：给一个房间发送文件，用户必须在当前房间

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| pid | 32位整数 | 必选 | 项目ID |
| from | 64位整数 | 必选 | 发送文件的用户ID |
| rid | 64位整数 | 必选 | 接收文件的房间ID |
| token | 字符串 | 必选 | filetoken接口返回的字符串token |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| file | 字符串 | 必选 | 文件内容 |
| attrs | 字符串 | 必选 | 文件附加属性，必须使用json格式，必须包含两项：ext：后缀名，sign：校验码 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

### 6. 系统行为相关 ###
#### (1) ping ####
说明：心跳，特定时间收不到心跳则关闭链接

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  |  |  |


| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  | 成功返回空消息，否则返回错误消息及错误  |

#### (2) bye ####
说明：客户端主动断开

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  |  |  |


| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  | 成功返回空消息，否则返回错误消息及错误  |

#### (3) addvariables ####
说明：添加KV结构的参数设置

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| var | 字典，KV均为字符串 | 必选 |  |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (4) adddebuglog ####
说明：发送日志给服务器

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| msg | 字符串 | 必选 | 日志内容 |
| attrs | 字符串 | 必选 | 日志附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

### 6. 用户个性化操作 ###
#### (1) setpushname ####
说明：设置在推送的时候使用的用户名

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| pushname | 字符串 | 必选 | 推送名字 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (2) getpushname ####
说明：获取在推送的时候使用的用户名

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  |  |  |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| pushname | 字符串 | 推送名字  |

#### (3) setgeo ####
说明：设置用户的经纬度

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| lat | 浮点型 | 必须 | 经度 |
| lng | 浮点型 | 必须 | 纬度 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  | 成功返回空消息，否则返回错误消息及错误码  |

#### (4) getgeo ####
说明：获取用户的经纬度

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  | | |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| lat | 浮点型 |  经度 |
| lng | 浮点型 |  纬度 |

#### (5) getgeos ####
说明：获取用户的经纬度

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| uids | 64位整数数组 | 必须 | 需要获取的用户ID列表，每次最多10人 |

返回如下结构的列表：

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| uid | 字符串 |  用户id |
| lat | 字符串 |  经度 |
| lng | 字符串 |  纬度 |

#### (6) adddevice ####
说明：添加设备，应用信息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| ptype | 字符串 | 必须 | 平台类型，ios，android |
| dtype | 字符串 | 必须 | 设备类型 |
| token | 字符串 | 必须 | token码 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  | 成功返回空消息，否则返回错误消息及错误码  |

#### (7) setlang ####
说明：设置当前用户期望翻译的语言

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| lang | 字符串 | 必须 | ISO 639-1 格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  | 成功返回空消息，否则返回错误消息及错误码  |

#### (8) translate ####
说明：主动翻译接口

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| text | 字符串 | 必须 | 需要翻译的文本 |
| src | 字符串 | 可选 | 原语言 类型 |
| dst | 字符串 | 必须 | 翻译成何种语言 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| stext | 字符串 | 原始文本  |
| src | 字符串 | 原始文本的语言类型，经翻译系统检测的  |
| dtext | 字符串 | 翻译后的文本  |
| dst | 字符串 | 翻译后的语言类型  |

### 7. 好友操作 ###
#### (1) addfriends ####
说明：添加好友，RTM系统的好友只是业务系统的一个镜像

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| friends | 64位整数数组 | 必选 | 需要添加的好友，每次最多100人 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (2) delfriends ####
说明：删除好友

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| friends | 64位整数数组 | 必选 | 需要添加的好友，每次最多100人 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (3) getfriends ####
说明：获取好友列表

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  | |  |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| uids | 64位整数数组 |  好友列表 |

### 8. 群组操作 ###
#### (1) addgroupmembers ####
说明：添加组成员，当前用户必须在组内，RTM系统的组关系只是业务系统的一个镜像

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| gid | 64位整数 | 必选 | 组ID |
| uids | 64位整数数组 | 必选 | 需要添加的组成员，每次最多100人 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (2) delgroupmembers ####
说明：删除组成员，当前用户必须在组内

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| gid | 64位整数 | 必选 | 组ID |
| uids | 64位整数数组 | 必选 | 需要添加的组成员，每次最多100人 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (3) getgroupmembers ####
说明：获取组中所有成员，当前用户必须在组内

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| gid | 64位整数 | 必选 | 组ID |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| uids | 64位整数数组 | 组成员列表 |

#### (4) getusergroups ####
说明：获取当前用户在哪些组内

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  | |  |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| gids | 64位整数数组 | 组列表 |

### 9. 房间操作 ###
#### (1) enterroom ####
说明：进入某个房间

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| rid | 64位整数 | 必选 | 房间ID |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (2) leaveroom ####
说明：离开某个房间

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| rid | 64位整数 | 必选 | 房间ID |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (3) getuserrooms ####
说明：获取当前用户在哪些房间内

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  |  |  |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| rooms | 64位整数数组 | 用户所在的房间列表 |

### 10. 获取在线用户 ###
#### (1) getonlineusers ####
说明：获取在线用户，每次最多获取200人

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| uids | 64位整数数组 | 必选 | 需要获取的在线用户 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| uids | 64位整数数组 |  在线用户列表 |


### 11. 服务器主动发送消息给客户端 ###
#### (1) kickout ####
说明：踢掉某个用户，单向操作

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| 无 |  |  | 关闭当前用户连接并进行必要清理 |

#### (2) pushmsg ####
说明：发送P2P消息给客户端

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| from | 64位整数 | 必选 | 发送方ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| ftype | 8位整数 | 必选 | 标示 文本消息 或者是文件 |
| msg | 字符串 | 必选 | 消息内容 |
| attrs | 字符串 | 必选 | 消息附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (3) pushgroupmsg ####
说明：发送组消息给客户端

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| from | 64位整数 | 必选 | 发送方ID |
| gid | 64位整数 | 必选 | 组ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| ftype | 8位整数 | 必选 | 标示 文本消息 或者是文件 |
| msg | 字符串 | 必选 | 消息内容 |
| attrs | 字符串 | 必选 | 消息附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (4) pushroommsg ####
说明：发送房间消息给客户端

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| from | 64位整数 | 必选 | 发送方ID |
| rid | 64位整数 | 必选 | 房间ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| ftype | 8位整数 | 必选 | 标示 文本消息 或者是文件 |
| msg | 字符串 | 必选 | 消息内容 |
| attrs | 字符串 | 必选 | 消息附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (5) pushbroadcastmsg ####
说明：发送广播消息给客户端

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| from | 64位整数 | 必选 | 发送方ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| mtype | 8位整数 | 必选 | 业务方使用，可以作为区分不同业务的标识，配合服务端，根据不同mtype做具体的动作 |
| ftype | 8位整数 | 必选 | 标示 文本消息 或者是文件 |
| msg | 字符串 | 必选 | 消息内容 |
| attrs | 字符串 | 必选 | 消息附加属性，建议使用json格式 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (6) transmsg ####
说明：发送翻译后的P2P消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| from | 64位整数 | 必选 | 发送方ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| omid | 64位整数 | 必选 | omid为原始消息的mid，用于对应关系 |
| msg | 字符串 | 必选 | 消息内容 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (7) transgroupmsg ####
说明：发送翻译后的组消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| from | 64位整数 | 必选 | 发送方ID |
| gid | 64位整数 | 必选 | 组ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| omid | 64位整数 | 必选 | omid为原始消息的mid，用于对应关系 |
| msg | 字符串 | 必选 | 消息内容 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (8) transroommsg ####
说明：发送翻译后的房间消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| from | 64位整数 | 必选 | 发送方ID |
| rid | 64位整数 | 必选 | 房间ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| omid | 64位整数 | 必选 | omid为原始消息的mid，用于对应关系 |
| msg | 字符串 | 必选 | 消息内容 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (9) transbroadcastmsg ####
说明：发送翻译后的广播消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| from | 64位整数 | 必选 | 发送方ID |
| mid | 64位整数 | 必选 | 消息的唯一标识，需保证在当前会话中唯一 |
| omid | 64位整数 | 必选 | omid为原始消息的mid，用于对应关系 |
| msg | 字符串 | 必选 | 消息内容 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

#### (10) pushunread ####
说明：发送未读消息

| 输入参数 | 类型 | 必要性 | 描述 |
|------|-------|-----|------|
| p2p | 64位整数数组 | 必选 | 哪些用户和自己有未读消息 |
| group | 64位整数数组 | 必选 | 哪些组和自己有未读消息 |
| bc | 布尔型 | 必选 | 是否有未读的广播消息 |

| 输出参数 | 类型 | 描述 |
|------|-------|------|
| 无 |  |  成功返回空消息，否则返回错误消息及错误码 |

